- id: MAC-FV-001
  title: FileVault enabled
  os: macos
  severity: high
  query:
    type: cmd
    cmd: "fdesetup status"
  expect:
    contains: "FileVault is On."
  fix: "System Settings → Privacy & Security → FileVault → Turn On"

- id: MAC-FW-001
  title: Application firewall enabled
  os: macos
  severity: high
  query:
    type: cmd
    cmd: "/usr/libexec/ApplicationFirewall/socketfilterfw --getglobalstate"
  expect:
    contains_any: ["enabled","State = 1"]
  fix: "sudo defaults write /Library/Preferences/com.apple.alf globalstate -int 1"

- id: MAC-GK-001
  title: Gatekeeper enabled
  os: macos
  severity: medium
  query:
    type: cmd
    cmd: "spctl --status"
  expect:
    contains: "assessments enabled"
  fix: "sudo spctl --master-enable"
